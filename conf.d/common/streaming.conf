# ============================================================================
# Streaming Configuration for Large Content
# ============================================================================
# Purpose: Special settings for streaming large content like Bible text
# Usage: Include this file in locations that serve streaming content
# ============================================================================

# Disable buffering for streaming responses
proxy_buffering off;
proxy_cache off;

# Disable gzip for streaming
gzip off;

# Set appropriate headers for streaming
proxy_set_header Connection "";
proxy_set_header X-Accel-Buffering no;  # Disable nginx buffering

# Extended timeouts for streaming
proxy_connect_timeout 10s;
proxy_send_timeout 300s;
proxy_read_timeout 300s;

proxy_buffer_size 8k;

# Don't buffer the response from upstream
proxy_max_temp_file_size 0;

# Ensure immediate delivery
proxy_force_ranges on;

# Disable output buffering completely
output_buffers 1 1k;
postpone_output 0;
