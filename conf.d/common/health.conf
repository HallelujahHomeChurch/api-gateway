# Health check and monitoring endpoints

# Health check endpoint (lightweight)
location = /health {
    access_log off;
    limit_req zone=health_limit burst=5 nodelay;
    
    return 200 '{"status":"ok","service":"api-gateway","timestamp":"$time_iso8601"}\n';
    add_header Content-Type application/json always;
    add_header Cache-Control "no-cache, no-store, must-revalidate" always;
}

# Metrics endpoint for monitoring (internal only)
location = /metrics {
    access_log off;
    
    # Only allow localhost (for internal monitoring)
    allow 127.0.0.1;
    deny all;
    
    stub_status on;
}

